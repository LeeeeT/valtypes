from regex import compile

user_info = compile(
    r"(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=)|:)*"
)

reg_name = compile(
    r"(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=))*"
)

authority = compile(
    r"(?:(?<user_info>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:)*)@)?(?:\[(?<host>(?:(?:(?:[0-9]|[A-F]){1,4}:){6}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|::(?:(?:[0-9]|[A-F]){1,4}:){5}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:[0-9]|[A-F]){1,4})?::(?:(?:[0-9]|[A-F]){1,4}:){4}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,1}(?:[0-9]|[A-F]){1,4})?::(?:(?:[0-9]|[A-F]){1,4}:){3}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,2}(?:[0-9]|[A-F]){1,4})?::(?:(?:[0-9]|[A-F]){1,4}:){2}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,3}(?:[0-9]|[A-F]){1,4})?::(?:[0-9]|[A-F]){1,4}:(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,4}(?:[0-9]|[A-F]){1,4})?::(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,5}(?:[0-9]|[A-F]){1,4})?::(?:[0-9]|[A-F]){1,4}|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,6}(?:[0-9]|[A-F]){1,4})?::)|v(?:[0-9]|[A-F])+\.(?:[A-Za-z]|[0-9]|\-|\.|_|~|!|\$|&|'|\(|\)|\*|\+|,|;|=|:)+)\]|(?<host>(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?<host>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=)*))(?::(?<port>[0-9]*))?"
)

segment = compile(
    r"(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=)|:|@)*"
)

path_abempty = compile(
    r"(?:/(?<segment>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)*))*"
)

query = compile(
    r"(?:(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=)|:|@)|/|\?)*"
)

fragment = compile(
    r"(?:(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=)|:|@)|/|\?)*"
)

segment_nz = compile(
    r"(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=)|:|@)+"
)

segment_nz_nc = compile(
    r"(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~)|(?:%%(?:[0-9]|[A-F])(?:[0-9]|[A-F]))|(?:!|\$|&|'|\(|\)|\*|\+|,|;|=)|@)+"
)

uri_full = compile(
    r"(?<scheme>[A-Za-z](?:[A-Za-z]|[0-9]|\+|\-|\.)*)://(?<authority>(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:)*@)?(?:(?:\[(?:(?:(?:(?:[0-9]|[A-F]){1,4}:){6}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|::(?:(?:[0-9]|[A-F]){1,4}:){5}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:[0-9]|[A-F]){1,4})?::(?:(?:[0-9]|[A-F]){1,4}:){4}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,1}(?:[0-9]|[A-F]){1,4})?::(?:(?:[0-9]|[A-F]){1,4}:){3}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,2}(?:[0-9]|[A-F]){1,4})?::(?:(?:[0-9]|[A-F]){1,4}:){2}(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,3}(?:[0-9]|[A-F]){1,4})?::(?:[0-9]|[A-F]){1,4}:(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,4}(?:[0-9]|[A-F]){1,4})?::(?:(?:(?:[0-9]|[A-F]){1,4}:(?:[0-9]|[A-F]){1,4})|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])))|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,5}(?:[0-9]|[A-F]){1,4})?::(?:[0-9]|[A-F]){1,4}|(?:(?:(?:[0-9]|[A-F]){1,4}:){0,6}(?:[0-9]|[A-F]){1,4})?::)|(?:v(?:[0-9]|[A-F])+\.(?:[A-Za-z]|[0-9]|\-|\.|_|~|!|\$|&|'|\(|\)|\*|\+|,|;|=|:)+))\])|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=)*)(?::[0-9]*)?)(?<path>(?:/(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)*)*)(?:\?(?<query>(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)|/|\?)*))?(?:\#(?<fragment>(?:(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)|/|\?)*))?"
)

path_absolute_full = compile(
    r"/(?<first_segment>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)+(?:/(?<other_segment>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)*))*)"
)

path_rootless = compile(
    r"(?<first_segment>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)+)(?:/(?<other_segment>(?:[A-Za-z]|[0-9]|\-|\.|_|~|%%(?:[0-9]|[A-F])(?:[0-9]|[A-F])|!|\$|&|'|\(|\)|\*|\+|,|;|=|:|@)*))*"
)
